{% extends "layout.html" %}
{% block content %}
<div class="container mt-4">
    <h2>Add Quiz</h2>
    <form method="POST" id="quiz-form">
        {{ form.hidden_tag() }}
        <div class="form-group">
            <label for="title">Title:</label>
            {{ form.title(class="form-control", placeholder="Enter quiz title") }}
        </div>
        <div class="form-group">
            <label for="class_id">Select Class:</label>
            <select class="form-control" id="class_id" name="class_id">
                {% for class_ in user_classes %}
                    <option value="{{ class_.id }}">{{ class_.class_name }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group">
            <label for="timer">Question Timer (seconds):</label>
            {{ form.timer(class="form-control", placeholder="Enter timer") }}
        </div>
        <div class="form-group">
            <label for="num_questions">Number of Questions:</label>
            <input type="number" class="form-control" id="num_questions" name="num_questions" min="1">
        </div>
        
        <div id="questions-container">
            <!-- This is where the dynamically generated question inputs will be inserted -->
        </div>
        <button type="submit" class="btn btn-primary">{{ form.submit }}</button>
    </form>
</div>

<!-- Existing form fields -->
<script>
    document.addEventListener("DOMContentLoaded", function() {
        const form = document.getElementById("quiz-form");
        const questionsContainer = document.getElementById("questions-container");

        document.getElementById("num_questions").addEventListener("change", function() {
            const numQuestions = parseInt(this.value);
            questionsContainer.innerHTML = "";

            for (let i = 1; i <= numQuestions; i++) {
                const questionDiv = document.createElement("div");
                questionDiv.className = "question";

                const questionInput = document.createElement("input");
                questionInput.type = "text";
                questionInput.name = "question_" + i;
                questionInput.placeholder = "Enter Question " + i;
                questionInput.className = "form-control mb-2";
                questionDiv.appendChild(questionInput);

                const optionInputContainer = document.createElement("div");

                for (let j = 1; j <= 4; j++) {
                    const optionInput = document.createElement("input");
                    optionInput.type = "text";
                    optionInput.name = "question_" + i + "_option_" + j;
                    optionInput.placeholder = "Option " + j;

                    if (j === 4) {
                        optionInput.placeholder += " (this is the correct option)";
                        optionInput.name = "question_" + i + "_correct_option";
                    }

                    optionInput.className = "form-control mb-2";
                    optionInputContainer.appendChild(optionInput);
                }

                questionDiv.appendChild(optionInputContainer);
                questionsContainer.appendChild(questionDiv);
            }
        });
    });

    // Inside the loop where you're creating option inputs
for (let j = 1; j <= 4; j++) {
    const optionInput = document.createElement("input");
    optionInput.type = "text";
    optionInput.name = "question_" + i + "_option_" + j;
    optionInput.placeholder = "Option " + j;

    if (j === 4) {
        optionInput.placeholder += " (this is the correct option)";
        optionInput.name = "question_" + i + "_correct_option_text"; // Use a different name for the text input
    }

    optionInput.className = "form-control mb-2";
    optionInputContainer.appendChild(optionInput);
    
    // Add a hidden input for the correct option value
    if (j === 4) {
        const correctOptionValueInput = document.createElement("input");
        correctOptionValueInput.type = "hidden";
        correctOptionValueInput.name = "question_" + i + "_correct_option"; // Use the original name for the value
        correctOptionValueInput.value = j; // Set the value of the correct option input
        optionInputContainer.appendChild(correctOptionValueInput);
    }
}

</script>



{% endblock content %}
